<script>
    async function checkARCoreCompatibility() {
        const modelViewer = document.getElementById('model-viewer');
        if (!modelViewer) {
            console.error("Model viewer not found.");
            return;
        }

        try {
            const isARCoreSupported = await navigator.xr.isSessionSupported('immersive-ar');
            if (!isARCoreSupported) {
                modelViewer.removeAttribute('ar');
                modelViewer.removeAttribute('ar-modes');
                alert('Your device is not compatible with AR features. You can still view the 3D model.');
            }
        } catch (error) {
            console.error('Error checking ARCore compatibility:', error);
            alert('An error occurred while checking AR compatibility.');
        }
    }

    const models = ['Lab1.glb', 'Lab2.glb', 'Lab3.glb'];
    const modelNames = ['Lab1', 'Lab2', 'Lab3'];
    let currentIndex = 0;

    function prevModel() {
        currentIndex = (currentIndex - 1 + models.length) % models.length;
        updateModel();
    }

    function nextModel() {
        currentIndex = (currentIndex + 1) % models.length;
        updateModel();
    }

    function updateModel() {
        const modelViewer = document.getElementById('model-viewer');
        if (!modelViewer) {
            console.error("Model viewer not found.");
            return;
        }

        const modelName = document.getElementById('model-name');
        modelViewer.setAttribute('src', models[currentIndex]);
        modelViewer.setAttribute('ios-src', modelNames[currentIndex] + '.usdz');
        modelName.innerText = modelNames[currentIndex];
    }

    document.addEventListener('DOMContentLoaded', () => {
        checkARCoreCompatibility();
        updateModel();

        document.getElementById('prevButton').addEventListener('click', prevModel);
        document.getElementById('nextButton').addEventListener('click', nextModel);
    });
</script>
